{"id":"crossplane-reconcile-paused","category":"troubleshooting","symptoms":["SYNCED=False","READY=True","ReconcilePaused in conditions"],"root_cause":"Crossplane resources are intentionally paused via crossplane.io/paused annotation. This is NOT an error - resources exist and are healthy in the cloud provider (READY=True).","investigation":["kubectl describe <resource> to check status.conditions","Look for Reason: ReconcilePaused with Status: False for Type: Synced","Check for crossplane.io/paused annotation"],"fixes":["This is intentional - resources are paused during maintenance or to reduce API calls","To resume: kubectl annotate <resource> crossplane.io/paused- (remove annotation)","READY=True means cloud resources are healthy despite SYNCED=False"],"related_patterns":["managed-resources","azure-roleassignments"]}
{"id":"crossplane-azure-providers","category":"reference","symptoms":["Need to check Crossplane provider health","Multiple Azure providers installed"],"root_cause":"Azure Crossplane setup uses family of providers (20+ Azure-specific providers for different services).","investigation":["kubectl get providers.pkg.crossplane.io","Check INSTALLED=True and HEALTHY=True columns","Common providers: provider-azure-authorization, provider-azure-storage, provider-azure-keyvault, provider-azure-sql, provider-azure-network, provider-azure-cosmosdb, etc."],"fixes":["All providers should show INSTALLED=True HEALTHY=True","If HEALTHY=False, check controller pod logs: kubectl logs -n crossplane-system -l pkg.crossplane.io/provider=<provider-name>","If provider missing, install: kubectl apply -f provider.yaml"],"related_patterns":["crossplane-provider-unhealthy","azure-rbac"]}
{"id":"crossplane-azure-databases","category":"reference","symptoms":["Finding Crossplane-managed databases","Azure database resources"],"root_cause":"Azure databases managed via Crossplane use specific CRDs: flexibleserver.dbformysql, account.cosmosdb, cassandracluster.cosmosdb, rediscache.cache","investigation":["kubectl get managed -A | grep -E '(postgres|sql|mysql|redis|cosmos)'","Check READY=True for healthy resources","SYNCED=False with READY=True often means ReconcilePaused (see crossplane-reconcile-paused)"],"fixes":["All database resources should show READY=True (exists in Azure)","Connection strings stored in Secrets in keyvault: kubectl get secret.keyvault.azure.upbound.io -A | grep -E '(connection|endpoint)'","To get database details: kubectl describe <database-resource>"],"related_patterns":["crossplane-reconcile-paused","azure-keyvault-secrets"]}
{"id":"crossplane-discovery-pattern","category":"methodology","symptoms":["Need to find Crossplane resources","Don't know CRD names","Generic 'managedresources' doesn't exist"],"root_cause":"Crossplane resources have specific API group names, not a generic 'managedresources' type. Must discover actual CRD names first.","investigation":["kubectl api-resources | grep -i crossplane (discover all Crossplane CRDs)","kubectl api-resources | grep -i <provider-name> (e.g., azure, aws, gcp)","kubectl get crd | grep crossplane","kubectl get managed -A (shortcut for all managed resources if configured)"],"fixes":["NEVER guess resource names like 'managedresources' or 'crossplaneresource'","ALWAYS use api-resources to discover actual plural names","Example: compositions.apiextensions.crossplane.io, not 'composition'","After discovery: kubectl get <discovered-plural-name> -A"],"related_patterns":["crd-discovery","custom-resources"]}
{"id":"custom-crd-debugging-universal","category":"methodology","symptoms":["Any custom CRD in failed/error state","Don't know where to find error message","CRD showing failed status","Unknown CRD field names"],"root_cause":"ALL custom CRDs follow same debugging pattern: status fields → events → controller logs. Different CRDs use different field names (message vs errorMessage vs currentState). Use intelligent field discovery instead of guessing.","investigation":["STEP 1: INTELLIGENT STATUS FIELD DISCOVERY (PREFERRED - works for ANY CRD): kubectl get <crd-type> <name> -n <namespace> -o json | jq -r '.status | to_entries | map(select(.key | test(\"message|error|reason|state|phase|condition|failure\"; \"i\"))) | .[] | \"\\(.key): \\(.value)\"' - This automatically finds ALL fields containing error/status keywords","STEP 2: Alternative - Try multiple common field names: kubectl get <crd-type> <name> -n <namespace> -o jsonpath='{.status.message}{.status.errorMessage}{.status.currentState}{.status.phase}{.status.reason}'","STEP 3: Fallback - Get full status manually: kubectl get <crd-type> <name> -n <namespace> -o yaml | grep -A30 'status:'","STEP 4: If describe output is truncated (shows '... omitted ...'), NEVER use describe - use jq/jsonpath instead","STEP 5: If status fields are empty/unhelpful, check events: kubectl get events -n <namespace> --field-selector involvedObject.name=<resource-name>","STEP 6: LAST RESORT - controller logs (only if status + events are empty): kubectl logs -n <controller-namespace> -l <controller-label>"],"fixes":["99% of errors are in status fields - use jq intelligent discovery to find them automatically","Common status field names: message, errorMessage, currentState, phase, reason, state, conditions","jq pattern works for ANY CRD regardless of field naming convention","If kubectl describe is truncated, ALWAYS use jq or jsonpath to get full status","Events are secondary - only useful if status is empty","Controller logs are LAST resort - only check if both status and events are empty"],"related_patterns":["crossplane-status-conditions","customercluster-asfailed","intelligent-field-discovery"]}
{"id":"crossplane-status-conditions","category":"troubleshooting","symptoms":["Crossplane resource not working","Need to check error conditions","SYNCED=False READY=False"],"root_cause":"Crossplane resources store detailed error information in status.conditions field with specific error messages from cloud provider APIs.","investigation":["kubectl describe <resource-type> <name> -n <namespace>","Look at Status.Conditions section","Check for Type: Synced or Type: Ready with Status: False","Read the Message and Reason fields for cloud API errors"],"fixes":["Common errors: AuthorizationFailed (403) → Missing Azure RBAC permissions; ResourceNotFound (404) → Referenced resource doesn't exist; QuotaExceeded (429) → Cloud quota limit; InvalidParameter → Bad configuration in spec","Fix based on specific error in conditions.message field","After fixing spec, Crossplane will retry reconciliation automatically"],"related_patterns":["azure-rbac-403","cloud-provider-errors","crossplane-reconcile-error","custom-crd-debugging-universal"]}
{"id":"customercluster-asfailed","category":"troubleshooting","symptoms":["CustomerCluster in ASFailed state","Current State: ASFailed","why is customercluster failing"],"root_cause":"CustomerCluster CRD does NOT have status.message or status.errorMessage fields. It only has status.currentState (ASReady/ASFailed/etc). When ASFailed, must check controller logs to find root cause.","investigation":["CustomerCluster status structure: {status: {currentState: ASFailed, versions: {...}}}","Step 1: kubectl get customercluster <name> -n <namespace> -o jsonpath='{.status.currentState}' confirms ASFailed","Step 2: kubectl get customercluster <name> -n <namespace> -o yaml | grep -A10 'status:' shows no error message","Step 3: Check controller logs: kubectl logs -n <namespace> -l control-plane=controller-manager --tail=100 | grep -i error","Step 4: Search for customercluster name in logs: kubectl logs -n <namespace> -l control-plane=controller-manager --tail=200 | grep -i <customercluster-name>"],"fixes":["CustomerCluster errors are in controller logs, not in CRD status","Common log patterns: reconciliation errors, Azure API errors, vCluster connectivity issues","Controller is typically in same namespace as CustomerCluster","Filter logs by customercluster name to find specific error"],"related_patterns":["custom-crd-debugging-universal","customerclusterenv-custom-crd"]}
{"id":"customerclusterenv-custom-crd","category":"troubleshooting","symptoms":["CustomerClusterEnv in EnvFailed state","Custom CRD with STATE field"],"root_cause":"CustomerClusterEnv follows universal CRD debugging pattern (see custom-crd-debugging-universal). Uses non-standard field names: STATE instead of READY/SYNCED.","investigation":["FOLLOW UNIVERSAL PATTERN: status → events → logs","kubectl get customerclusterenv <name> -n <namespace> -o yaml | grep -A30 'status:'","Status field names: status.currentState, status.message, status.errorMessage","Check STATE column (not READY/SYNCED)"],"fixes":["STATE=EnvFailed indicates environment provisioning failure","Error in status.currentState or status.message","Controller logs LAST RESORT: kubectl logs -n <namespace> -l control-plane=controller-manager"],"related_patterns":["custom-crd-debugging-universal","customercluster-asfailed"]}
